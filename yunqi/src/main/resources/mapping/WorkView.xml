<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yunqi.common.viewMapper.WorkViewMapper">
    <select id="select" resultType="com.yunqi.common.view.WorkView">
        # 工单查询
        select *
        from workView w where 1 = 1 and disabled is null
        <if test="techId!=null">
            and techNames like #{techId,jdbcType=VARCHAR}
        </if>
        <if test="projectId!=null">
            and projectId like #{projectId,jdbcType=VARCHAR}
        </if>
        <if test="workId!=null">
            and workId = #{workId}
        </if>
        <if test="type!=null and type!=''">
            and type = #{type}
        </if>
        <if test="status!=null and status!=''">
            and status is null
        </if>
        <if test="projectName!=null and projectName!=''">
            and ( projectName like #{projectName,jdbcType=VARCHAR}
            or telephone like #{projectName,jdbcType=VARCHAR}
            or address like #{projectName,jdbcType=VARCHAR} )
        </if>
        <if test="dateOfVisit != null">
            and date_format(`dateOfVisit`,'%Y-%m-%d') = str_to_date(#{dateOfVisit},'%Y-%m-%d')
        </if>
        <if test="headId!=null">
            and headId = #{headId}
        </if>
        order by dateOfVisit desc
    </select>
</mapper>