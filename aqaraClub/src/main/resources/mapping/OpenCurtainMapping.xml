<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aqara.common.mapper.OpenCurtainMapper">
    <resultMap id="BaseResultMap" type="com.aqara.common.entity.OpenCurtain">
        <result column="id" jdbcType="INTEGER" property="id"/>
        <result column="code" jdbcType="VARCHAR" property="code"/>
        <result column="sales" jdbcType="VARCHAR" property="sales"/>
        <result column="department" jdbcType="VARCHAR" property="department"/>
        <result column="number" jdbcType="VARCHAR" property="number"/>
        <result column="supplier" jdbcType="VARCHAR" property="supplier"/>
        <result column="merchantConfirm" jdbcType="VARCHAR" property="merchantConfirm"/>
        <result column="createName" jdbcType="VARCHAR" property="createName"/>
        <result column="createTime" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="updateName" jdbcType="VARCHAR" property="updateName"/>
        <result column="updateTime" jdbcType="TIMESTAMP" property="updateTime"/>
    </resultMap>

    <select id="currentData" resultType="com.aqara.common.entity.OpenCurtain">
        select *
        from openCurtain
        where 1 = 1
          and supplier is not null
          and merchantConfirm = '已制作'
          and TO_DAYS(NOW()) - TO_DAYS(updateTime) >= 5
    </select>

    <select id="currentData1" resultType="com.aqara.common.entity.OpenCurtain">
        select *
        from openCurtain
        where 1 = 1
          and supplier is not null
          and merchantConfirm is null
          and TO_DAYS(NOW()) - TO_DAYS(updateTime) >= 3
    </select>

    <insert id="insert" parameterType="com.aqara.common.entity.OpenCurtain" useGeneratedKeys="true" keyProperty="id">
        insert into openCurtain (code, sales, department, number, supplier, merchantConfirm,
                                 createName, createTime, updateName, updateTime)
        values (#{code}, #{sales}, #{department}, #{number}, #{supplier}, #{merchantConfirm},
                #{createName}, NOW(), #{updateName}, NOW())
    </insert>

    <insert id="upload" parameterType="com.aqara.common.entity.OpenCurtain" useGeneratedKeys="true" keyProperty="id">
        insert into openCurtain (code, sales, department, number, supplier, merchantConfirm,
                                 createName, createTime, updateName, updateTime)
        values (#{code}, #{sales}, #{department}, #{number}, #{supplier}, #{merchantConfirm},
                #{createName}, #{createTime,jdbcType=DATE}, #{updateName}, #{updateTime,jdbcType=DATE})
    </insert>

    <delete id="delete" parameterType="com.aqara.common.entity.OpenCurtain">
        delete
        from openCurtain
        where 1 = 1
    </delete>
</mapper>